<div class="container">

  <div class="row">
    <button type="button" class="btn btn-secondary btn-sm" (click)="dialog.showModal()">
      <i class="fa fa-bookmark" aria-hidden="true"></i> Creation visite
    </button>
  </div>

  <div class="row">
    <table class="table table-striped table-hover table-sm">
      <thead>
        <tr>
          <th scope="col">Voiture</th>
          <th scope="col">Date debut Visite</th>
          <th scope="col">Status</th>
          <th scope="col">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let l of list">
          <th scope="row">{{numero}} </th>
          <td>{{l['date_debut']}} </td>
          <td>
            <span
              [ngClass]="{'badge badge-pill badge-primary': l['etat'] == 0 , 'badge badge-pill badge-warning': l['etat'] == 1 , 'badge badge-pill badge-success': l['etat'] == 2 }">
              {{ l['etat'] == 0 ? 'En cours' : (l['etat']== 1 ? 'Terminé non payé' : 'Terminé payé' ) }}
            </span>
          </td>
          <td>
            <button type="button" class="btn btn-info btn-sm btn-valider"
              (click)="dialog_reparation.showModal() ; initForm(l['_id'])">
              <i class="fa fa-wrench" aria-hidden="true"></i> Reparation
            </button>
          </td>
        </tr>
      </tbody>
    </table>

  </div>
</div>



<div>
  <dialog #dialog>
    <header>
      <div class="title">Creation visite</div>
      <span class="close-btn" (click)="dialog.close()"> ✖ </span>
    </header>
    <span class="center">
      Voulez-vous creer une visite pour la voiture {{numero}} ?
    </span>
    <div class="center">
      <button class="btn btn-success btn-sm" type="submit" (click)="dialog.close()">Ok</button>
      <span style="margin-right: 10px;"></span>
      <button class="btn btn-danger btn-sm" (click)="dialog.close()">Annuler</button>
    </div>
  </dialog>
</div>


<div>
  <dialog #dialog_reparation>
    <header>
      <div class="title">Creation reparation</div>
      <span class="close-btn" (click)="dialog_reparation.close()"> ✖ </span>
    </header>
    <div class="center">
      <form [formGroup]="formulaire" (ngSubmit)="onSubmit()" *ngIf="this.formulaire">
        <div class="form-group">
          <label>Pièce</label>
          <input formControlName="piece" type="text" class="form-control">
          <div *ngIf="submitted && f.piece.errors">
            <small *ngIf="f.piece.errors.required" style="color: red">Champ Obligtoire</small>
          </div>
        </div>

        <div class="form-group">
          <label>Durée</label>
          <input formControlName="duree" type="text" class="form-control">
          <div *ngIf="submitted && f.duree.errors">
            <small *ngIf="f.duree.errors.required" style="color: red">Champ Obligtoire</small>
            <small *ngIf="f.duree.errors.pattern" style="color: red">La valeur du champ doit être un nombre</small>
            <small *ngIf="f.duree.errors.min" style="color: red">la valeur du champ doit être supérieure à 0 </small>
          </div>
        </div>

        <div class="form-group">
          <label>Avancement</label>
          <input formControlName="avancement" type="text" class="form-control">
          <div *ngIf="submitted && f.avancement.errors">
            <small *ngIf="f.avancement.errors.required" style="color: red">Champ Obligtoire</small>
          </div>
        </div>

        <div class="form-group">
          <label>Prix</label>
          <input formControlName="prix" type="text" class="form-control">
          <div *ngIf="submitted && f.prix.errors">
            <small *ngIf="f.prix.errors.required" style="color: red">Champ Obligtoire</small>
            <small *ngIf="f.prix.errors.pattern" style="color: red">La valeur du champ doit être un nombre</small>
            <small *ngIf="f.prix.errors.min" style="color: red">la valeur du champ doit être supérieure à 0 </small>
          </div>
        </div>


        <div class="center">
          <button class="btn btn-success btn-sm" type="submit"
            (click)="dialog_reparation.close() ; creationreparation() ">Ok</button>
          <span style="margin-right: 10px;"></span>
          <button class="btn btn-danger btn-sm" (click)="dialog_reparation.close()">Annuler</button>
        </div>
      </form>
    </div>
  </dialog>
</div>
